<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SimComm • SimComm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SimComm">
<meta property="og:description" content="SimComm">
<meta property="og:image" content="https://ericmarcon.github.io/SimComm/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SimComm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/SimComm.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/EricMarcon/SimComm/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>SimComm</h1>
            <h3 class="subtitle">A Simulator of Communities</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EricMarcon/SimComm/blob/master/vignettes/SimComm.Rmd"><code>vignettes/SimComm.Rmd</code></a></small>
      <div class="hidden name"><code>SimComm.Rmd</code></div>

    </div>

    
    
<p>This is a preliminary version of a package designed to simulate spatially-explicit communities.</p>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>Install the package for <em>R</em> from Github.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"remotes"</span>)
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"EricMarcon/SimComm"</span>)</pre></body></html></div>
</div>
<div id="demo" class="section level1">
<h1 class="hasAnchor">
<a href="#demo" class="anchor"></a>Demo</h1>
<p>The package allows running community models represented by a spatial pattern. The pattern may be a matrix, a grid of points or a point pattern. To add a new model, an R6 class must be created to describe it. It must inherit from one of these base classes, depending on the pattern it relies on:</p>
<ul>
<li><p><code>community_matrixmodel</code> for matrices,</p></li>
<li><p><code>community_gridmodel</code> for point grids.</p></li>
</ul>
<div id="conways-game-of-life" class="section level2">
<h2 class="hasAnchor">
<a href="#conways-game-of-life" class="anchor"></a>Conway’s game of life</h2>
<p>The <code>cm_Conway</code> class is such a <a href="https://en.wikipedia.org/wiki/Conway%27s_Game_of_Life">model</a>. The community is represented by a logical matrix where each cell is either occupied or not. An occupied cell survives if its number of neighbors is in the values of the vector <code>to_survive</code>, 2 or 3 by default. An empty cell gets populated if its number of neighbors is in the values of the vector <code>to_generate</code>, 3 by default. The neighborhood may be defined according to <a href="https://en.wikipedia.org/wiki/Von_Neumann_neighborhood">von Neumann</a> or <a href="https://en.wikipedia.org/wiki/Moore_neighborhood">Moore</a>. Default is Moore neighborood of order 1, i.e. the 8 surrounding cells.</p>
<p>Writing a new model consists of defining its fields (here: <code>to_survive</code>, <code>to_generate</code> and <code>neighborhood</code>), its <code>initialize</code> method and a private method named <code>evolve</code>. The <code>evolve</code> methode codes for the evolution of each individual of the community at each step of time. In Conway’s game of life, each occupied cell may survive or die and each empty cell may come to life or not.</p>
<p>A model is used in two steps. It must first be instantiated through its <code>new</code> method. Its initial pattern and the timeline to run it along are the arguments.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"SimComm"</span>)
<span class="no">myModel</span> <span class="kw">&lt;-</span> <span class="no">cm_Conway</span>$<span class="fu">new</span>(<span class="kw">pattern</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/SimComm/man/patterns.html">pm_Conway_blinker</a></span>(), <span class="kw">timeline</span><span class="kw">=</span><span class="fl">0</span>:<span class="fl">10</span>)</pre></body></html></div>
<p>Several functions allow producing parameterized patterns, see <code><a href="https://rdrr.io/pkg/SimComm/man/patterns.html">help(patterns)</a></code>. The <code><a href="https://rdrr.io/pkg/SimComm/man/patterns.html">pm_Conway_blinker()</a></code> function returns a rectangular pattern designed to oscillate when evolving.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">myModel</span>$<span class="fu">autoplot</span>()</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Evolution is launched by the <code>run</code> method. The timeline defines the evolution time: its first value corresponds to the initial patterns, and the <code>evolve</code> method will be run along all other values. Animation on screen is allowed by <code>animate = TRUE</code>. The time between two steps is defined by <code>sleep</code>, in seconds. If <code>save</code> is set to <code>TRUE</code>, then all patterns are saved.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">myModel</span>$<span class="fu">run</span>(<span class="kw">animate</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">sleep</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">save</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p>Saving patterns allows plotting them at a chosen time:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">p5</span> <span class="kw">&lt;-</span> <span class="no">myModel</span>$<span class="fu">autoplot</span>(<span class="kw">time</span><span class="kw">=</span><span class="fl">5</span>)+ <span class="fu">theme</span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">"none"</span>)
<span class="no">p6</span> <span class="kw">&lt;-</span> <span class="no">myModel</span>$<span class="fu">autoplot</span>(<span class="kw">time</span><span class="kw">=</span><span class="fl">6</span>)+ <span class="fu">theme</span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">"none"</span>)
<span class="no">p7</span> <span class="kw">&lt;-</span> <span class="no">myModel</span>$<span class="fu">autoplot</span>(<span class="kw">time</span><span class="kw">=</span><span class="fl">7</span>)+ <span class="fu">theme</span>(<span class="kw">legend.position</span><span class="kw">=</span><span class="st">"none"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"gridExtra"</span>)
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span>(<span class="no">p5</span>, <span class="no">p6</span>, <span class="no">p7</span>, <span class="kw">ncol</span><span class="kw">=</span><span class="fl">3</span>)</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-4-1.png" width="700"> The <code>along_time</code> method allows applying a function to all saved patterns and return its value along time. The number of occupied cells is constant along the evolution of the model. The <code>sum</code> function is used to count them:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="no">myModel</span>$<span class="fu">along_time</span>(<span class="no">sum</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">y</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Time"</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">"Number of living cells"</span>)</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="a-community-drift-model" class="section level2">
<h2 class="hasAnchor">
<a href="#a-community-drift-model" class="anchor"></a>A community drift model</h2>
<p>This simple model simulates the loss of diversity in a small community. The community is a matrix where each cell contains an individual. Marks are species. At each generation, each individual is replaced by one of its neighbors</p>
<p>First, initialize the model.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">myModel</span> <span class="kw">&lt;-</span> <span class="no">cm_drift</span>$<span class="fu">new</span>(<span class="fu"><a href="https://rdrr.io/pkg/SimComm/man/patterns.html">pattern_matrix_individuals</a></span>(<span class="kw">nx</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">ny</span> <span class="kw">=</span> <span class="fl">8</span>, <span class="kw">S</span> <span class="kw">=</span> <span class="fl">20</span>, <span class="kw">Distribution</span> <span class="kw">=</span> <span class="st">"lnorm"</span>))
<span class="no">myModel</span>$<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>()</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Choose an evolution time of 1000 steps.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">myModel</span>$<span class="no">timeline</span> <span class="kw">&lt;-</span> <span class="fl">0</span>:<span class="fl">1000</span></pre></body></html></div>
<p>Run the model, save its steps.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">myModel</span>$<span class="fu">run</span>(<span class="kw">animate</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">save</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p>Plot the final state.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">myModel</span>$<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>()</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Plot the evolution of richness.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">myModel</span>$<span class="fu">along_time</span>(<span class="no">Richness</span>, <span class="kw">Correction</span><span class="kw">=</span><span class="st">"None"</span>) <span class="kw">%&gt;%</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="no">x</span>, <span class="kw">y</span><span class="kw">=</span><span class="no">y</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="kw">x</span><span class="kw">=</span><span class="st">"Time"</span>, <span class="kw">y</span><span class="kw">=</span><span class="st">"Number of species"</span>)</pre></body></html></div>
<p><img src="SimComm_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eric Marcon, Alain Rousteau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
